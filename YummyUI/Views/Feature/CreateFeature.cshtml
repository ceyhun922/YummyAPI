@using YummyUI.DTOs.FeatureDTO
@model CreateFeatureDto

@{
    Layout = "_AdminLayout";
}

<style>
  .ai-form, .ai-form * { box-sizing: border-box; }

  .ai-form {
    min-height: 100%;
    padding: 2rem;
    background:
      radial-gradient(1200px 600px at 70% 80%, rgba(139, 92, 246, .25), transparent 60%),
      radial-gradient(900px 500px at 15% 20%, rgba(99, 102, 241, .30), transparent 60%),
      linear-gradient(135deg, #0a0e27 0%, #16213e 40%, #0f1729 100%);
  }

  /* 2 s√ºtun: sol form + saƒü preview */
  .layout-grid{
    max-width: 1140px;
    margin: 0 auto;
    display: grid;
    grid-template-columns: 1fr 420px;
    gap: 1.6rem;
    align-items: start;
  }

  .panel{
    background: rgba(15, 23, 42, .60);
    border-radius: 28px;
    border: 1px solid rgba(255, 255, 255, .12);
    backdrop-filter: blur(18px);
    box-shadow: 0 40px 90px rgba(0, 0, 0, .55);
  }

  .form-wrap{ padding: 2rem 2.2rem; }

  .form-head{
    display:flex;
    align-items:center;
    gap:1rem;
    margin-bottom: 1.6rem;
  }

  .form-badge{
    width:54px;height:54px;border-radius:18px;display:grid;place-items:center;
    background: linear-gradient(135deg, #667eea, #764ba2);
    box-shadow: 0 14px 40px rgba(102, 126, 234, .6);
    font-size: 1.6rem;
  }

  .form-title{
    margin:0;
    font-size:1.9rem;
    font-weight:950;
    background: linear-gradient(135deg, #fff, #a8b9ff);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
  }

  .form-sub{
    margin:.2rem 0 0 0;
    color: rgba(255,255,255,.65);
    font-weight:700;
    font-size:.95rem;
  }

  .f-group{ margin-bottom: 1.2rem; }
  .f-label{
    display:block;
    margin-bottom:.45rem;
    color: rgba(255,255,255,.85);
    font-weight:800;
    font-size:.9rem;
  }

  .f-input{
    width:100%;
    padding:.9rem 1rem;
    border-radius:14px;
    border:1px solid rgba(255,255,255,.15);
    background: rgba(255,255,255,.06);
    color:#fff;
    font-size:.95rem;
    outline:none;
    transition: all .35s cubic-bezier(.16,1,.3,1);
  }
  .f-input:focus{
    border-color:#667eea;
    background: rgba(255,255,255,.08);
    box-shadow: 0 0 0 4px rgba(102,126,234,.25);
  }

  textarea.f-input{ resize:none; min-height: 110px; }

  /* switch */
  .status-wrap{
    display:flex;
    align-items:center;
    gap:.6rem;
    margin-top:.4rem;
  }
  .status-wrap label{
    font-weight:800;
    color: rgba(255,255,255,.85);
  }

  /* buttons */
  .form-actions{
    margin-top: 1.8rem;
    display:flex;
    gap: 1rem;
    flex-wrap: wrap;
  }
  .btn-ai{
    border:none;
    border-radius:16px;
    padding: 1rem 1.4rem;
    font-weight:950;
    cursor:pointer;
    display:inline-flex;
    align-items:center;
    gap:.6rem;
    color:#fff;
    text-decoration:none;
    transition: transform .35s cubic-bezier(.16,1,.3,1), box-shadow .35s ease;
  }
  .btn-ai:hover{
    transform: translateY(-2px);
    box-shadow: 0 18px 45px rgba(0,0,0,.35);
  }
  .btn-primary{
    background: linear-gradient(135deg, #667eea, #764ba2);
    box-shadow: 0 14px 40px rgba(102,126,234,.55);
  }
  .btn-ghost{
    background: rgba(255,255,255,.06);
    border: 1px solid rgba(255,255,255,.14);
    box-shadow: 0 14px 40px rgba(0,0,0,.25);
  }

  /* preview panel */
  .preview{
    padding: 1.3rem 1.3rem 1.4rem;
    position: sticky;
    top: 1.2rem;
  }

  .preview-top{
    display:flex;
    align-items:flex-start;
    justify-content: space-between;
    gap: .8rem;
    margin-bottom: 1rem;
  }

  .pv-title{
    font-size: 1.1rem;
    font-weight: 950;
    color: rgba(255,255,255,.95);
    line-height: 1.15;
  }
  .pv-sub{
    margin-top:.35rem;
    color: rgba(255,255,255,.65);
    font-weight: 750;
    font-size: .9rem;
  }

  .pill{
    display:inline-flex;
    align-items:center;
    gap:.45rem;
    padding: .42rem .75rem;
    border-radius: 999px;
    border:1px solid rgba(255,255,255,.14);
    background: rgba(255,255,255,.06);
    color: rgba(255,255,255,.85);
    font-weight: 850;
    font-size: .85rem;
    white-space: nowrap;
  }
  .dot{
    width:10px;height:10px;border-radius:50%;
    background:#f59e0b;
    box-shadow: 0 0 0 4px rgba(245,158,11,.18);
  }

  .pv-img{
    margin-top: 1rem;
    width:100%;
    height: 180px;
    border-radius: 18px;
    border:1px solid rgba(255,255,255,.12);
    background: rgba(255,255,255,.04);
    overflow:hidden;
    display:grid;
    place-items:center;
  }
  .pv-img img{ width:100%; height:100%; object-fit:cover; display:none; }
  .pv-ph{
    color: rgba(255,255,255,.55);
    font-weight: 800;
    text-align:center;
    padding: 0 1rem;
  }

  .pv-desc{
    margin-top: 1rem;
    padding: 1rem;
    border-radius: 18px;
    border:1px solid rgba(255,255,255,.12);
    background: rgba(255,255,255,.05);
    color: rgba(255,255,255,.75);
    font-weight: 700;
    line-height: 1.35;
    min-height: 84px;
  }

  @@media(max-width: 980px){
    .layout-grid{ grid-template-columns: 1fr; }
    .preview{ position: static; }
  }
</style>

<div class="ai-form">
  <div class="layout-grid">

    <!-- SOL: FORM -->
    <div class="panel form-wrap">
      <div class="form-head">
        <div class="form-badge">‚≠ê</div>
        <div>
          <h1 class="form-title">Yeni √ñne √áƒ±kan Alan</h1>
          <p class="form-sub">Ba≈ülƒ±q, alt ba≈ülƒ±q, a√ßƒ±klama v…ô ≈ü…ôkil …ôlav…ô edin</p>
        </div>
      </div>

      @using (Html.BeginForm("CreateFeature", "Feature", FormMethod.Post, new { enctype="multipart/form-data", id="featureForm" }))
      {
        <div class="f-group">
          <label class="f-label">Ba≈ülƒ±k</label>
          @Html.TextBoxFor(x => x.FeatureTitle, new { @class = "f-input", placeholder = "√ñrn: Yeni ƒ∞li Bizimle Ke√ßirin", id="FeatureTitle" })
        </div>

        <div class="f-group">
          <label class="f-label">Alt Ba≈ülƒ±k</label>
          @Html.TextBoxFor(x => x.FeatureTitle2, new { @class = "f-input", placeholder = "A√ßƒ±klama metni giriniz", id="FeatureTitle2" })
        </div>

        <div class="f-group">
          <label class="f-label">Hakkƒ±nda</label>
          @Html.TextAreaFor(x => x.FeatureDescription, new { @class = "f-input", placeholder = "Detaylƒ± a√ßƒ±klama...", id="FeatureDescription" })
        </div>

        <!-- ‚úÖ file input -->
        <div class="f-group">
          <label class="f-label">G√∂rsel (Dosya)</label>
          <input type="file" name="file" id="FeatureFile" class="f-input" accept=".jpg,.jpeg,.png,.webp" />
        </div>

        <div class="status-wrap">
          @Html.CheckBoxFor(x => x.FeatureStatus, new { id="FeatureStatus" })
          <label>Aktif</label>
        </div>

        <div class="form-actions">
          <button type="submit" class="btn-ai btn-primary">üíæ Kaydet</button>
          <button type="button" class="btn-ai btn-ghost" id="btnClearPreview">üßπ √ñnizlemeyi Temizle</button>
        </div>
      }
    </div>

    <!-- SAƒû: PREVIEW -->
    <aside class="panel preview">
      <div class="preview-top">
        <div>
          <div class="pv-title" id="pvTitle">√ñrn: Yeni ƒ∞li Bizimle Ke√ßirin</div>
          <div class="pv-sub" id="pvSub">Alt ba≈ülƒ±k burada g√∂r√ºn√ºr</div>
        </div>

        <div class="pill">
          <span class="dot" id="pvDot"></span>
          <span id="pvStatusText">Pasif</span>
        </div>
      </div>

      <div class="pv-img">
        <img id="pvImg" alt="preview" />
        <div class="pv-ph" id="pvPh">G√∂rsel √∂nizlemesi burada g√∂r√ºnecek.</div>
      </div>

      <div class="pv-desc" id="pvDesc">‚Äú A√ßƒ±klama burada g√∂r√ºn√ºr. ‚Äù</div>
    </aside>

  </div>
</div>
@section Scripts{
<script>
  (function () {
    const el = (id) => document.getElementById(id);

    const t = el("FeatureTitle");
    const s = el("FeatureTitle2");
    const d = el("FeatureDescription");
    const f = el("FeatureFile");
    const st = el("FeatureStatus");

    const pvTitle = el("pvTitle");
    const pvSub = el("pvSub");
    const pvDesc = el("pvDesc");
    const pvImg = el("pvImg");
    const pvPh = el("pvPh");

    const pvStatusText = el("pvStatusText");
    const pvDot = el("pvDot");

    const safe = (v, fallback) => {
      const x = (v || "").trim();
      return x.length ? x : fallback;
    };

    function updatePreview() {
      pvTitle.textContent = safe(t.value, "√ñrn: Yeni ƒ∞li Bizimle Ke√ßirin");
      pvSub.textContent = safe(s.value, "Alt ba≈ülƒ±k burada g√∂r√ºn√ºr");
      pvDesc.textContent = "‚Äú " + safe(d.value, "A√ßƒ±klama burada g√∂r√ºn√ºr.") + " ‚Äù";

      const active = st && st.checked;
      pvStatusText.textContent = active ? "Aktif" : "Pasif";
      pvDot.style.background = active ? "#22c55e" : "#f59e0b";
      pvDot.style.boxShadow = active ? "0 0 0 4px rgba(34,197,94,.18)" : "0 0 0 4px rgba(245,158,11,.18)";
    }

    function updateImage() {
      if (!f.files || !f.files[0]) {
        pvImg.style.display = "none";
        pvImg.src = "";
        pvPh.style.display = "block";
        return;
      }
      const url = URL.createObjectURL(f.files[0]);
      pvImg.src = url;
      pvImg.style.display = "block";
      pvPh.style.display = "none";
    }

    [t, s, d].forEach(i => i && i.addEventListener("input", updatePreview));
    st && st.addEventListener("change", updatePreview);
    f && f.addEventListener("change", () => { updateImage(); updatePreview(); });

    el("btnClearPreview").addEventListener("click", function () {
      // preview reset
      pvTitle.textContent = "√ñrn: Yeni ƒ∞li Bizimle Ke√ßirin";
      pvSub.textContent = "Alt ba≈ülƒ±k burada g√∂r√ºn√ºr";
      pvDesc.textContent = "‚Äú A√ßƒ±klama burada g√∂r√ºn√ºr. ‚Äù";

      pvStatusText.textContent = "Pasif";
      pvDot.style.background = "#f59e0b";
      pvDot.style.boxShadow = "0 0 0 4px rgba(245,158,11,.18)";

      if (f) f.value = "";
      updateImage();
    });

    updatePreview();
    updateImage();
  })();
</script>
}