@using YummyUI.DTOs.ChefDTOs
@model GetByIdChefDto
@{
    Layout = "_AdminLayout";
}

<style>
/* ===== AI PREMIUM UPDATE FORM ===== */
.ai-form,
.ai-form *{ box-sizing:border-box; }

.ai-form{
  min-height:100%;
  padding:2rem;
  background:
    radial-gradient(1200px 600px at 70% 80%, rgba(139,92,246,.25), transparent 60%),
    radial-gradient(900px 500px at 15% 20%, rgba(99,102,241,.30), transparent 60%),
    linear-gradient(135deg,#0a0e27 0%,#16213e 40%,#0f1729 100%);
}

.form-wrap{
  max-width:720px;
  margin:0 auto;
  background:rgba(15,23,42,.60);
  border-radius:28px;
  border:1px solid rgba(255,255,255,.12);
  backdrop-filter:blur(18px);
  box-shadow:0 40px 90px rgba(0,0,0,.55);
  padding:2rem 2.2rem;
}

.form-head{
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:1rem;
  margin-bottom:1.6rem;
}

.head-left{
  display:flex;
  align-items:center;
  gap:1rem;
}

.form-badge{
  width:54px;height:54px;
  border-radius:18px;
  display:grid;place-items:center;
  background:linear-gradient(135deg,#667eea,#764ba2);
  box-shadow:0 14px 40px rgba(102,126,234,.6);
  font-size:1.6rem;
}

.form-title{
  margin:0;
  font-size:1.9rem;
  font-weight:950;
  background:linear-gradient(135deg,#fff,#a8b9ff);
  -webkit-background-clip:text;
  -webkit-text-fill-color:transparent;
}

.form-sub{
  margin:.2rem 0 0 0;
  color:rgba(255,255,255,.65);
  font-weight:700;
  font-size:.95rem;
}

.preview{
  width:64px;
  height:64px;
  border-radius:18px;
  overflow:hidden;
  border:1px solid rgba(255,255,255,.14);
  background:rgba(255,255,255,.06);
  box-shadow:0 18px 45px rgba(0,0,0,.35);
  display:grid;
  place-items:center;
  flex:0 0 auto;
}
.preview img{
  width:100%;
  height:100%;
  object-fit:cover;
  display:block;
}
.preview .noimg{
  font-weight:900;
  color:rgba(255,255,255,.8);
  font-size:.75rem;
}

/* inputs */
.f-group{ margin-bottom:1.2rem; }

.f-label{
  display:block;
  margin-bottom:.45rem;
  color:rgba(255,255,255,.85);
  font-weight:800;
  font-size:.9rem;
}

.f-input{
  width:100%;
  padding:.9rem 1rem;
  border-radius:14px;
  border:1px solid rgba(255,255,255,.15);
  background:rgba(255,255,255,.06);
  color:#fff;
  font-size:.95rem;
  outline:none;
  transition:all .45s cubic-bezier(.16,1,.3,1);
}

.f-input:focus{
  border-color:#667eea;
  background:rgba(255,255,255,.08);
  box-shadow:0 0 0 4px rgba(102,126,234,.25);
}

/* textarea */
textarea.f-input{
  resize:none;
  min-height:90px;
}

/* status */
.status-wrap{
  display:flex;
  align-items:center;
  gap:.6rem;
  margin-top:.4rem;
}
.status-wrap label{
  font-weight:800;
  color:rgba(255,255,255,.85);
}

/* buttons */
.form-actions{
  margin-top:1.8rem;
  display:flex;
  gap:1rem;
  flex-wrap:wrap;
}

.btn-ai{
  border:none;
  border-radius:16px;
  padding:1rem 1.4rem;
  font-weight:950;
  cursor:pointer;
  display:inline-flex;
  align-items:center;
  gap:.6rem;
  color:#fff;
  text-decoration:none;
  transition:transform .45s cubic-bezier(.16,1,.3,1),
             box-shadow .45s ease,
             opacity .2s ease;
}

.btn-ai:hover{
  transform:translateY(-2px);
  box-shadow:0 18px 45px rgba(0,0,0,.35);
}

.btn-primary{
  background:linear-gradient(135deg,#f59e0b,#d97706);
  box-shadow:0 14px 40px rgba(245,158,11,.35);
}

.btn-cancel{
  background:linear-gradient(135deg,#374151,#111827);
  box-shadow:0 14px 40px rgba(0,0,0,.45);
}

/* responsive */
@@media(max-width:700px){
  .form-wrap{ padding:1.5rem; }
  .form-title{ font-size:1.6rem; }
  .form-head{ align-items:flex-start; }
}
</style>

<div class="ai-form">
  <div class="form-wrap">

    <div class="form-head">
      <div class="head-left">
        <div class="form-badge">üõ†Ô∏è</div>
        <div>
          <h1 class="form-title">≈ûef G√ºncelle</h1>
          <p class="form-sub">Premium AI destekli ≈üef profil d√ºzenleme</p>
        </div>
      </div>

      <div class="preview" id="chefPreview">
        @if (Model.ImageFile != null)
        {
          <img id="chefPreviewImg"
               src="@Model.ImageFile"
               alt="@Model.ChefName"
               onerror="this.onerror=null;this.style.display='none';this.parentElement.innerHTML='<div class=&quot;noimg&quot;>No Img</div>';" />
        }
        else
        {
          <div class="noimg">No Img</div>
        }
      </div>
    </div>

    @using (Html.BeginForm("UpdateChef","Chef",FormMethod.Post))
    {
      @Html.HiddenFor(c=>c.ChefId)

      <div class="f-group">
        <label class="f-label">≈ûef ƒ∞smi</label>
        @Html.TextBoxFor(c=>c.ChefName,new{@class="f-input", placeholder="Ahmet Yƒ±lmaz"})
      </div>

      <div class="f-group">
        <label class="f-label">Uzmanlƒ±k / √únvan</label>
        @Html.TextBoxFor(c=>c.ChefTitle,new{@class="f-input", placeholder="Ba≈ü ≈ûef"})
      </div>

      <div class="f-group">
        <label class="f-label">A√ßƒ±klama</label>
        @Html.TextAreaFor(c=>c.ChefDescription,new{@class="f-input", placeholder="20 yƒ±llƒ±k deneyime sahip..."})
      </div>

      <div class="f-group">
        <label class="f-label">Profil Fotoƒüraf URL</label>
        @Html.TextBoxFor(c=>c.ImageFile,new{@class="f-input", id="ChefImageUrl", placeholder="https://..."})
      </div>

      <div class="f-group">
        <label class="f-label">Facebook</label>
        @Html.TextBoxFor(c=>c.ChefFacebookUrl,new{@class="f-input"})
      </div>

      <div class="f-group">
        <label class="f-label">Instagram</label>
        @Html.TextBoxFor(c=>c.ChefInstagramUrl,new{@class="f-input"})
      </div>

      <div class="f-group">
        <label class="f-label">LinkedIn</label>
        @Html.TextBoxFor(c=>c.ChefLinkedinUrl,new{@class="f-input"})
      </div>

      <div class="f-group">
        <label class="f-label">X (Twitter)</label>
        @Html.TextBoxFor(c=>c.ChefXUrl,new{@class="f-input"})
      </div>

      <div class="status-wrap">
        @Html.CheckBoxFor(c=>c.ChefStatus)
        <label>Aktif olarak yayƒ±nla</label>
      </div>

      <div class="form-actions">
        <button type="submit" class="btn-ai btn-primary">
          ‚ú® G√ºncelle
        </button>

        <a asp-action="Index" asp-controller="Chef" class="btn-ai btn-cancel">
          ‚Ü©Ô∏è Vazge√ß
        </a>
      </div>
    }

  </div>
</div>

<script>
(function () {
  const input = document.getElementById("ChefImageUrl") || document.querySelector('input[name="ChefImageUrl"]');
  const previewBox = document.getElementById("chefPreview") || document.querySelector(".preview");

  if (!input || !previewBox) return;

  let img = previewBox.querySelector("img");

  function showNoImg() {
    previewBox.innerHTML = '<div class="noimg">No Img</div>';
    img = null;
  }

  function ensureImg() {
    if (!img) {
      previewBox.innerHTML = '<img id="chefPreviewImg" alt="Preview" />';
      img = previewBox.querySelector("img");
    }
    return img;
  }

  function updatePreview(url) {
    const val = (url || "").trim();
    if (!val) {
      showNoImg();
      return;
    }

    const el = ensureImg();

    el.onload = function(){ /* ok */ };
    el.onerror = function(){ showNoImg(); };

    // Cache-bypass tiny (aynƒ± url tekrar yazƒ±lƒ±nca da g√ºncellesin)
    const cacheBust = (val.includes("?") ? "&" : "?") + "v=" + Date.now();
    el.src = val + cacheBust;
  }

  // ƒ∞lk deƒüer
  updatePreview(input.value);

  // Yazdƒ±k√ßa anlƒ±k
  input.addEventListener("input", function () {
    updatePreview(this.value);
  });
})();
</script>
