@using YummyUI.DTOs.GalleryDTO
@model CreateGalleryDto
@{
    Layout = "_AdminLayout";
    ViewData["Title"] = "Yeni Galeri";
}

@section Styles{
<style>
/* ===== SAME PREMIUM ORGC STYLE ===== */
.orgc, .orgc * { box-sizing: border-box; }
.orgc{
  min-height:100%;
  padding:1.6rem 2rem;
  position:relative;
  overflow:hidden;
  background:
    radial-gradient(1200px 600px at 70% 80%, rgba(56,189,248,.18), transparent 60%),
    radial-gradient(900px 500px at 15% 20%, rgba(139,92,246,.22), transparent 60%),
    radial-gradient(800px 420px at 90% 10%, rgba(99,102,241,.18), transparent 55%),
    linear-gradient(135deg, #070b1f 0%, #0a1030 40%, #050818 100%);
}

.orgc .orb{
  position:absolute; border-radius:999px; filter:blur(100px);
  opacity:.55; pointer-events:none; animation:orgFloat 14s ease-in-out infinite;
}
.orgc .orb.a{ width:520px; height:520px; left:-180px; top:-180px; background:rgba(139,92,246,.42); }
.orgc .orb.b{ width:460px; height:460px; right:-190px; top:110px; background:rgba(56,189,248,.36); animation-delay:3s; }
.orgc .orb.c{ width:560px; height:560px; left:38%; bottom:-260px; background:rgba(99,102,241,.30); animation-delay:6s; }

@@keyframes orgFloat{
  0%,100%{ transform:translate(0,0) scale(1); }
  50%{ transform:translate(18px,-14px) scale(1.04); }
}

.orgc .grid{
  position:absolute; inset:0; pointer-events:none; opacity:.14;
  background-image:
    linear-gradient(rgba(255,255,255,0.06) 1px, transparent 1px),
    linear-gradient(90deg, rgba(255,255,255,0.06) 1px, transparent 1px);
  background-size:64px 64px;
}

.orgc .wrap{ position:relative; z-index:2; max-width:1200px; margin:0 auto; display:flex; flex-direction:column; gap:1.1rem; }
.orgc .header{ display:flex; align-items:center; justify-content:space-between; gap:1rem; }
.orgc .titleBox{ display:flex; align-items:center; gap:.9rem; }
.orgc .badge{
  width:56px; height:56px; border-radius:18px; display:grid; place-items:center;
  background:linear-gradient(135deg, #667eea, #764ba2);
  border:1px solid rgba(255,255,255,.14);
  box-shadow:0 18px 55px rgba(102,126,234,.45), 0 0 45px rgba(118,75,162,.25);
  color:#fff;
}
.orgc .badge i{ font-size:26px; }
.orgc .h1{
  margin:0; font-size:2rem; font-weight:950;
  background:linear-gradient(135deg, #fff, #a8b9ff);
  -webkit-background-clip:text; -webkit-text-fill-color:transparent;
}
.orgc .sub{ margin:.2rem 0 0 0; color:rgba(255,255,255,.70); font-weight:800; font-size:.95rem; }

.orgc .shell{
  background:rgba(15,23,42,.55);
  border-radius:28px;
  border:1px solid rgba(255,255,255,.12);
  backdrop-filter:blur(16px);
  box-shadow:0 40px 90px rgba(0,0,0,.45);
  overflow:hidden;
}
.orgc .shellHead{
  padding:1.1rem 1.25rem;
  border-bottom:1px solid rgba(255,255,255,.08);
  display:flex; align-items:center; justify-content:space-between; gap:1rem;
}
.orgc .shellHead p{ margin:0; color:rgba(255,255,255,.75); font-weight:850; }
.orgc .chip{
  padding:.45rem .8rem; border-radius:999px;
  border:1px solid rgba(255,255,255,.12);
  background:rgba(255,255,255,.06);
  color:rgba(255,255,255,.88);
  font-weight:900; font-size:.85rem; white-space:nowrap;
}
.orgc .body{ padding:1.25rem; }
.orgc .grid2{ display:grid; grid-template-columns:1.35fr .65fr; gap:1.1rem; align-items:start; }

.orgc .group{ margin-bottom:1rem; }
.orgc .label{ display:block; margin-bottom:.45rem; font-weight:950; color:rgba(255,255,255,.92); }
.orgc .input, .orgc .textarea{
  width:100%; padding:.95rem 1rem; border-radius:16px;
  border:1px solid rgba(255,255,255,.12);
  background:rgba(255,255,255,.06);
  color:rgba(255,255,255,.92);
  font-weight:800; outline:none;
  transition:box-shadow .15s ease, border-color .15s ease, background .15s ease;
}
.orgc .input::placeholder, .orgc .textarea::placeholder{ color:rgba(255,255,255,.55); }
.orgc .input:focus, .orgc .textarea:focus{
  border-color:rgba(102,126,234,.55);
  box-shadow:0 0 0 4px rgba(102,126,234,.18);
  background:rgba(255,255,255,.08);
}
.orgc .textarea{ min-height:120px; resize:vertical; }

.orgc .row{ display:flex; gap:.8rem; align-items:center; flex-wrap:wrap; }
.orgc .previewBox{
  width:64px; height:64px; border-radius:18px;
  border:1px dashed rgba(255,255,255,.20);
  background:rgba(255,255,255,.06);
  display:grid; place-items:center; flex:0 0 auto; overflow:hidden;
}
.orgc .previewBox img{ width:100%; height:100%; object-fit:cover; display:none; }
.orgc .previewBox .ph{ color:rgba(255,255,255,.85); font-weight:950; font-size:.95rem; }

.orgc .thumbs{ margin-top:.7rem; display:grid; grid-template-columns:repeat(4, minmax(0,1fr)); gap:.65rem; }
.orgc .thumb{
  border-radius:18px; overflow:hidden; height:86px;
  border:1px solid rgba(255,255,255,.12);
  background:rgba(255,255,255,.06);
  cursor:pointer; position:relative;
  transition:transform .18s ease, border-color .18s ease, background .18s ease;
}
.orgc .thumb:hover{ transform:translateY(-2px); border-color:rgba(102,126,234,.35); background:rgba(255,255,255,.08); }
.orgc .thumb img{ width:100%; height:100%; object-fit:cover; display:block; }
.orgc .thumb::after{
  content:"Seç"; position:absolute; right:10px; bottom:10px;
  padding:.3rem .55rem; border-radius:999px;
  font-weight:950; font-size:.78rem; color:#fff;
  border:1px solid rgba(255,255,255,.16);
  background:rgba(15,23,42,.55); backdrop-filter:blur(10px);
}

.orgc .statusRow{ display:flex; align-items:center; gap:.75rem; }
.orgc .switch{
  width:56px; height:32px; border-radius:999px;
  background:rgba(255,255,255,.14);
  border:1px solid rgba(255,255,255,.12);
  position:relative; cursor:pointer;
  transition:background .2s ease, border-color .2s ease;
  flex:0 0 auto;
}
.orgc .switch::after{
  content:""; width:26px; height:26px; border-radius:999px;
  position:absolute; top:50%; left:3px; transform:translateY(-50%);
  background:#fff; box-shadow:0 12px 20px rgba(0,0,0,.22);
  transition:left .2s ease;
}
.orgc .switch.on{ background:rgba(34,197,94,.22); border-color:rgba(34,197,94,.30); }
.orgc .switch.on::after{ left:27px; }
.orgc .statusText{ font-weight:950; color:rgba(255,255,255,.75); }
.orgc .statusText.on{ color:#22c55e; }

.orgc .live{
  position:sticky; top:90px;
  border-radius:22px;
  background:rgba(255,255,255,.06);
  border:1px solid rgba(255,255,255,.12);
  box-shadow:0 24px 70px rgba(0,0,0,.35);
  overflow:hidden;
}
.orgc .liveImg{ height:160px; background:rgba(0,0,0,.22); position:relative; }
.orgc .liveImg img{ width:100%; height:100%; object-fit:cover; display:block; }
.orgc .liveShade{ position:absolute; inset:0; background:linear-gradient(180deg, rgba(0,0,0,.10) 0%, rgba(0,0,0,.60) 100%); }
.orgc .liveBody{ padding:1rem 1.05rem 1.1rem; }
.orgc .liveName{ margin:0; color:#fff; font-weight:950; font-size:1.15rem; }
.orgc .liveBadges{ margin-top:.85rem; display:flex; gap:.5rem; flex-wrap:wrap; }
.orgc .pill{
  padding:.45rem .75rem; border-radius:999px;
  border:1px solid rgba(255,255,255,.12);
  background:rgba(15,23,42,.55);
  color:rgba(255,255,255,.92);
  font-weight:950; font-size:.82rem; white-space:nowrap;
}
.orgc .pill.green{ border-color:rgba(34,197,94,.22); background:rgba(34,197,94,.12); color:#b7f7cf; }
.orgc .pill.orange{ border-color:rgba(245,158,11,.22); background:rgba(245,158,11,.12); color:#ffe0b0; }

.orgc .actions{ margin-top:1.05rem; display:flex; gap:.7rem; flex-wrap:wrap; }
.orgc .save{
  border:none; padding:.95rem 1.2rem; border-radius:16px; font-weight:950; cursor:pointer;
  background:linear-gradient(135deg, #22c55e, #16a34a);
  color:#052e16;
  box-shadow:0 16px 35px rgba(34,197,94,.18);
  transition:transform .18s ease, box-shadow .18s ease, opacity .18s ease;
}
.orgc .save:hover{ transform:translateY(-2px); box-shadow:0 22px 52px rgba(34,197,94,.22); }
.orgc .back{
  border:none; padding:.95rem 1.1rem; border-radius:16px; font-weight:950; cursor:pointer;
  background:rgba(255,255,255,.12);
  color:rgba(255,255,255,.92);
  transition:transform .18s ease, opacity .18s ease;
  text-decoration:none;
  display:inline-flex; align-items:center; gap:.55rem;
}
.orgc .back:hover{ transform:translateY(-2px); }
.orgc .back:active{ transform:translateY(0); opacity:.96; }

@@media (max-width: 980px){
  .orgc{ padding:1.1rem; }
  .orgc .grid2{ grid-template-columns:1fr; }
  .orgc .live{ position:static; }
  .orgc .h1{ font-size:1.6rem; }
}
</style>
}

<div class="orgc">
  <div class="orb a"></div>
  <div class="orb b"></div>
  <div class="orb c"></div>
  <div class="grid"></div>

  <div class="wrap">
    <div class="header">
      <div class="titleBox">
        <div class="badge"><i class="bi bi-images"></i></div>
        <div>
          <div class="h1">Yeni Galeri</div>
          <div class="sub">Başlıq • şəkil • status</div>
        </div>
      </div>
    </div>

    <div class="shell">
      <div class="shellHead">
        <p>Galeri ekleme paneli</p>
        <span class="chip">Live Preview</span>
      </div>

      <div class="body">
        @using (Html.BeginForm("CreateGallery", "Gallery", FormMethod.Post, new { @enctype = "multipart/form-data" }))
        {
          <div class="grid2">

            <!-- LEFT -->
            <div>
              <div class="group">
                <label class="label" for="GalTitle">Galeri Başlığı</label>
                @Html.TextBoxFor(x => x.GalleryTitle, new {
                  @class="input",
                  id="GalTitle",
                  placeholder="Örn: Restoran Açılış Günü",
                  autocomplete="off"
                })
              </div>

              <div class="group">
                <label class="label">Görsel</label>

                <div class="row">
                  @* Preset/path input *@
                  @Html.TextBoxFor(x => x.GalleryImageUrl, new {
                    @class="input",
                    id="GalImage",
                    placeholder="Örn: /Yummy/assets/img/gallery/g-1.jpg",
                    autocomplete="off"
                  })

                  @* Upload input *@
                  <input type="file" name="file" id="GalImageFile" class="input" accept="image/*" />

                  <div class="previewBox" title="Canlı görsel">
                    <img id="ImgPreview" alt="preview" />
                    <div class="ph" id="ImgPh">IMG</div>
                  </div>
                </div>
                <div class="thumbs" id="Thumbs">
                  <div class="thumb" data-src="/Yummy/assets/img/gallery/g-1.jpg"><img src="/Yummy/assets/img/gallery/g-1.jpg" alt="g-1" /></div>
                  <div class="thumb" data-src="/Yummy/assets/img/gallery/g-2.jpg"><img src="/Yummy/assets/img/gallery/g-2.jpg" alt="g-2" /></div>
                  <div class="thumb" data-src="/Yummy/assets/img/gallery/g-3.jpg"><img src="/Yummy/assets/img/gallery/g-3.jpg" alt="g-3" /></div>
                  <div class="thumb" data-src="/Yummy/assets/img/gallery/g-4.jpg"><img src="/Yummy/assets/img/gallery/g-4.jpg" alt="g-4" /></div>
                </div> 

                <div style="margin-top:.55rem; color: rgba(255,255,255,.70); font-weight:800; font-size:.92rem;">
                  Resmi tıkla seç. Input’a yol otomatik yazılır və sağda preview yenilənir.
                </div>
              </div>

              <div class="group">
                <label class="label">Durum</label>

                <div style="display:none;">
                  @Html.CheckBoxFor(x => x.GallerySatatus, new { id="GalStatusCb" })
                </div>

                <div class="statusRow">
                  <div class="switch" id="GalSwitch" role="button" tabindex="0"></div>
                  <div class="statusText" id="GalStatusText">Pasif</div>
                </div>
              </div>

              <div class="actions">
                <button type="submit" class="save">✅ Kaydet</button>
                <a class="back" asp-action="GalleryList" asp-controller="Gallery">↩️ Geri Dön</a>
              </div>
            </div>

            <!-- RIGHT -->
            <div class="live">
              <div class="liveImg">
                <img id="LiveImg"
                     src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='1200' height='600'%3E%3Crect width='1200' height='600' fill='%230b1225'/%3E%3Ctext x='50%25' y='50%25' text-anchor='middle' fill='%23667eea' font-family='Arial' font-size='44'%3EPreview%3C/text%3E%3C/svg%3E"
                     alt="live" />
                <div class="liveShade"></div>
              </div>
              <div class="liveBody">
                <p class="liveName" id="LiveTitle">Örn: Galeri Başlığı</p>
                <div class="liveBadges">
                  <span class="pill orange" id="LiveStatus">Pasif</span>
                </div>
              </div>
            </div>

          </div>
        }
      </div>
    </div>
  </div>
</div>

@section Scripts{
<script>
(function () {
  const $ = (id) => document.getElementById(id);

  const titleI = $("GalTitle");
  const imgI = $("GalImage");
  const fileI = $("GalImageFile");
  const cb = $("GalStatusCb");

  const imgPrev = $("ImgPreview");
  const imgPh = $("ImgPh");
  const liveImg = $("LiveImg");
  const liveTitle = $("LiveTitle");
  const liveStatus = $("LiveStatus");

  const sw = $("GalSwitch");
  const st = $("GalStatusText");

  const thumbs = $("Thumbs");

  function setPreview(src) {
    const v = (src || "").trim();
    if (!v) {
      imgPrev.style.display = "none";
      imgPh.style.display = "block";
      liveImg.src = "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='1200' height='600'%3E%3Crect width='1200' height='600' fill='%230b1225'/%3E%3Ctext x='50%25' y='50%25' text-anchor='middle' fill='%23667eea' font-family='Arial' font-size='44'%3EPreview%3C/text%3E%3C/svg%3E";
      return;
    }

    imgPrev.src = v;
    liveImg.src = v;

    imgPrev.onload = () => { imgPrev.style.display = "block"; imgPh.style.display = "none"; };
    imgPrev.onerror = () => { imgPrev.style.display = "none"; imgPh.style.display = "block"; };
  }

  function setStatus(on) {
    if (on) {
      sw.classList.add("on");
      st.classList.add("on");
      st.textContent = "Aktif";
      liveStatus.className = "pill green";
      liveStatus.textContent = "Aktif";
    } else {
      sw.classList.remove("on");
      st.classList.remove("on");
      st.textContent = "Pasif";
      liveStatus.className = "pill orange";
      liveStatus.textContent = "Pasif";
    }
    cb.checked = !!on;
  }

  // init
  liveTitle.textContent = (titleI.value || "").trim() || "Örn: Galeri Başlığı";
  setPreview(imgI.value);
  setStatus(cb.checked);

  // events
  titleI.addEventListener("input", e => {
    liveTitle.textContent = (e.target.value || "").trim() || "Örn: Galeri Başlığı";
  });

  imgI.addEventListener("input", e => setPreview(e.target.value));

  fileI.addEventListener("change", (e) => {
    const f = e.target.files && e.target.files[0];
    if (!f) return;
    const url = URL.createObjectURL(f);

    imgPrev.style.display = "block";
    imgPh.style.display = "none";
    imgPrev.src = url;
    liveImg.src = url;
  });

  thumbs.addEventListener("click", (e) => {
    const t = e.target.closest(".thumb");
    if (!t) return;
    const src = t.getAttribute("data-src");
    imgI.value = src;
    setPreview(src);
  });

  sw.addEventListener("click", () => setStatus(!cb.checked));
  sw.addEventListener("keydown", (e) => {
    if (e.key === "Enter" || e.key === " ") {
      e.preventDefault();
      setStatus(!cb.checked);
    }
  });
})();
</script>
}
